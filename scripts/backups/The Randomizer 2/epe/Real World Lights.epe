{
  "name": "Real World Lights",
  "id": "DFag5iWc28uHcz3qk",
  "sources": {
    "main": "/*\n Real World Lights \n \n Emulates the general color and look, if not the exact spectral characteristics\n of some interesting real-world light sources, selectable by UI slider.  The lights \n are, in order:\n \n   0 - Candlelight*\n   1 - Warm white incandescent \n   2 - Soft white incandescent\n   3 - Cool white incandescent\n   4 - Uranium glass fluorescence* (https://en.wikipedia.org/wiki/Uranium_glass)\n   5 - High pressure sodium lamp\n   6 - Mercury Vapor lamp\n   7 - Sodium vapor lamp\n   8 - Warm fluorescent tube\n   9 - Cool fluorescent tube\n  10 - LED grow light (vegetative phase)\n  11 - Ultraviolet (black light) tube\n  12 - Cherenkov radiation* (\"normal\" light if you have a nuclear reactor handy)\n  \n  (* - lights with movement effects/flicker)\n   \n   Tested on APA102 and RGB WS2812b. Some colors may\n   need adjustment on RGBW LEDs, depending on\n   the particular shade of the 'W' LED. \n   \n MIT License\n Take this code and use it to make cool things!\n \n ZRanger1 01/22/2022\n*/ \n\n// light index definitions\n  candle = 0\n  warm_white = 1\n  soft_white = 2\n  cool_white = 3\n  uranium_glass = 4\n  hp_sodium = 5 \n  mercury = 6\n  sodium_vapor = 7\n  warm_fl = 8\n  cool_fl = 9\n  fl_grow = 10 \n  ultraviolet = 11\n  cherenkov = 12\n\n// arrays for light parameters\nvar nLights = 13;    \nvar preLight = array(nLights);\nvar renderLight = array(nLights);\n\n// global color values for animation control and use in render\nvar speed,t1,t2,t3,t4;\nvar r,g,b,h,s,v;\n\n///////\n// Tables of functions for the light sources\n//////\n\npreLight[cool_white] = (delta) => ctToRGB(66);   // Cool white incandescent\nrenderLight[cool_white] = (index) => rgb(r,g,b);\n\npreLight[warm_white] = (delta) => ctToRGB(29);   // Warm White incandescent\nrenderLight[warm_white] = (index) => rgb(r,g,b);\n\npreLight[soft_white] = (delta) => ctToRGB(40);   // Soft white incandescent\nrenderLight[soft_white] = (index) => rgb(r,g,b);\n\npreLight[fl_grow] = (delta) => { ;};   // Fluorescent grow light\nrenderLight[fl_grow] = renderGrowLight;\n\npreLight[warm_fl] = (delta) => {r=1;g=0.8;b=0.8;};   // Warm fluorescent tube\nrenderLight[warm_fl] = (index) => rgb(r,g,b);\n\npreLight[cool_fl] = (delta) => {r=.831;g=0.922;b=1;};   // Cool fluorescent tube\nrenderLight[cool_fl] = (index) => rgb(r,g,b);\n\npreLight[ultraviolet] = (delta) => {r=0.655;g=0;b=1;};  // black light tube\nrenderLight[ultraviolet] = (index) => rgb(r,g,b);\n\npreLight[mercury] = (delta) => {r=0.55;g=1;b=.58;};   // mercury vapor lamp\nrenderLight[mercury] = (index) => rgb(r,g,b);\n\npreLight[uranium_glass] = (delta) => {speed = 0.85;h = 0.2673;s = 1;v = 1};    \nrenderLight[uranium_glass] = renderUraniumGlass;\n\npreLight[sodium_vapor] = (delta) => {h = 0.08;s=0.902};     // sodium vapor\nrenderLight[sodium_vapor] = (index) => hsv(h,s,1);\n\npreLight[candle] = (delta) => {speed = 0.4;h = 0.05;s=0.98;v=1} // candlelight\nrenderLight[candle] = renderCandle;\n\npreLight[hp_sodium] = (delta) => {h = 0.04;s=0.969;};   // high pressure sodium\nrenderLight[hp_sodium] = (index) => hsv(h,s,1);\n\npreLight[cherenkov] = (delta) => {speed = 0.85;h = 0.591;s = 0.997;v = 1};     \nrenderLight[cherenkov] = renderCherenkov;\n\n// UI controls\nexport var nCurrentLight = 0;\nexport function sliderLightType(v) {\n    nCurrentLight = floor(v * (nLights - 1));\n}\n\n// smooth 1D noise (sum of sines). Returns value\n// in the range -1 to 1\nfunction noise(index) {\n  var x,v;\n  x = index/pixelCount;\n  v =  (wave((33 * x) - t1) - 0.5) << 1;\n  v += (wave((45 * x) + t2) - 0.5) << 1;\n  v += (wave((21 * x) + t3) - 0.5) << 1;\n  v += (wave((15 * x) - t4) - 0.5) << 1;\n  return v >> 2;   \n}\n\n// candle renderer adds a little movement\nfunction preCandle(delta) {\n  speed = 0.5;\n  h = 0.05;s=0.98; \n}\n\nfunction renderCandle(index) {\n  var v = noise(index);\n  hsv(h-(0.015 * triangle(v+index/pixelCount)), s, max(0.35,v));\n}\n\n// grow light for vegetative phase plants...\nfunction renderGrowLight(index) {\n  var pct = wave(index/pixelCount*60); pct = 0.33 * pct * pct\n  hsv(0.65+pct,1,1)\n}\n\n// add a little internal brightness variation for fluorescence\nfunction renderUraniumGlass(index) {\n  var v = noise(index);\n  hsv(h, s, max(0.25,v));\n}\n\n// variation for radiation effects\nfunction renderCherenkov(index) {\n  var n = noise(index/3);\n  hsv(h, 1, max(0.2,n));\n}\n\n// convert color temp in degrees K/100 to RGB color\nfunction ctToRGB(ct){\n    \n    if( ct < 67 ){ \n        r = 1;\n        g = 0.5313 * log(ct) - 1.2909;\n        \n        if( ct <= 19){\n            b = 0;\n        } else {\n            b = 0.0223 * ct - 0.5063;\n        }\n    } else {\n        r = 38.309 * pow(ct,-0.886);\n        g = 10.771 * pow(ct,-0.588);\n        b = 1;\n    }\n    \n    r = clamp(r,0, 1);\n    g = clamp(g,0, 1);\n    b = clamp(b,0, 1);\n}\n\nexport function beforeRender(delta) {\n\n  // a few timers we can use for internal variation\n  t1 = time(speed *.16);\n  t2 = time(speed *.1);\n  t3 = time(speed *.14);\n  t4 = time(speed *.11);    \n  \n  preLight[nCurrentLight](delta);\n}\n\nexport function render(index) {\n  renderLight[nCurrentLight](index);\n}"
  },
  "preview": "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"
}